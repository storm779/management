<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add What's New Item</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- External CSS Files -->
    <link th:href="@{/css/consolidated-style.css}" rel="stylesheet">
</head>
<body>
    <!-- Sticky Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success navbar-sticky">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <img src="/images/logo.png" alt="HP Logo" class="me-2" style="height: 32px; width: auto;">Visakh Refinery Portal
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                            <i class="bi bi-house me-1"></i>Dashboard
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" th:href="@{/}">
                                <i class="bi bi-speedometer2 me-1"></i>Main Dashboard</a></li>
                        </ul>
                    </li>
                    
                    <!-- What's New section - accessible to everyone -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle active" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-newspaper me-1"></i>What's New
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/whatsnew/list">
                                <i class="bi bi-list-ul me-1"></i>View All
                            </a></li>
                            <li sec:authorize="hasRole('ADMIN')"><hr class="dropdown-divider"></li>
                            <li sec:authorize="hasRole('ADMIN')"><a class="dropdown-item active" href="/whatsnew/add">
                                <i class="bi bi-plus-circle me-1"></i>Add New Announcement
                            </a></li>
                        </ul>
                    </li>

                    <!-- Message Board section - accessible to everyone -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-chat-square-text me-1"></i>Message Board
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/messageboard/list">
                                <i class="bi bi-list-ul me-1"></i>View All Messages
                            </a></li>
                            <li sec:authorize="hasRole('ADMIN')"><hr class="dropdown-divider"></li>
                            <li sec:authorize="hasRole('ADMIN')"><a class="dropdown-item" href="/messageboard/add">
                                <i class="bi bi-plus-circle me-1"></i>Add New Message
                            </a></li>
                        </ul>
                    </li>
                </ul>
                
                <ul class="navbar-nav">
                    <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle me-1"></i>
                            <span sec:authentication="name">Admin User</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><h6 class="dropdown-header">
                                <span sec:authentication="name">Admin User</span>
                            </h6></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form th:action="@{/logout}" method="post" class="d-inline">
                                    <button type="submit" class="dropdown-item text-danger">
                                        <i class="bi bi-box-arrow-right me-1"></i>Logout
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-wrapper">
        <div class="container mt-4">
            <!-- Back to List Button -->
            <div class="d-flex justify-content-end mb-3">
                <a href="/whatsnew/list" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-1"></i>Back to List
                </a>
            </div>

        <!-- Alert Messages -->
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle me-2"></i>
            <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle me-2"></i>
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

            <!-- Form Card -->
            <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <form th:action="@{/whatsnew/save}" method="post" th:object="${whatsNew}">
                            <!-- Hidden ID field for edit operations -->
                            <input type="hidden" th:field="*{id}">
                            
                            <div class="row">
                                <!-- Left Column -->
                                <div class="col-lg-8">
                            <!-- Title -->
                            <div class="mb-3">
                                <label for="title" class="form-label">
                                            <i class="bi bi-card-text me-1"></i>Title <span class="text-danger">*</span>
                                </label>
                                <input type="text" 
                                       class="form-control" 
                                       id="title" 
                                       th:field="*{title}" 
                                       placeholder="Enter announcement title"
                                       maxlength="200"
                                       required>
                                <div class="form-text">Maximum 200 characters</div>
                            </div>
                            
                            <!-- URL -->
                            <div class="mb-3">
                                        <label for="url" class="form-label">
                                            <i class="bi bi-link-45deg me-1"></i>URL
                                        </label>
                                <input type="url" 
                                       class="form-control" 
                                       id="url" 
                                       th:field="*{url}" 
                                       placeholder="https://example.com or document/file.pdf (optional)"
                                       maxlength="500">
                                <div class="form-text">Link to more information or document path (optional)</div>
                            </div>
                            
                            <!-- Date Range -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="validFrom" class="form-label">
                                                <i class="bi bi-calendar-check me-1"></i>Valid From <span class="text-danger">*</span>
                                    </label>
                                    <input type="date" 
                                           class="form-control" 
                                           id="validFrom" 
                                           th:field="*{validFrom}" 
                                           required>
                                </div>
                                <div class="col-md-6">
                                            <label for="validTo" class="form-label">
                                                <i class="bi bi-calendar-x me-1"></i>Valid To
                                            </label>
                                    <input type="date" 
                                           class="form-control" 
                                           id="validTo" 
                                           th:field="*{validTo}"
                                           placeholder="Leave empty for no expiry">
                                    <div class="form-text">Leave empty for no expiry date</div>
                                        </div>
                                </div>
                            </div>
                            
                                <!-- Right Column -->
                                <div class="col-lg-4">
                            <!-- Settings -->
                                    <div class="card border-light mb-3">
                                        <div class="card-header bg-light">
                                            <h6 class="mb-0">
                                                <i class="bi bi-gear me-1"></i>Settings
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <!-- Priority -->
                                            <div class="mb-3">
                                                <label for="priority" class="form-label">
                                                    <i class="bi bi-exclamation-triangle me-1"></i>Priority Level
                                                </label>
                                    <select class="form-select" 
                                            id="priority" 
                                            th:field="*{priority}">
                                                    <option value="1">1 - Highest Priority</option>
                                                    <option value="2" selected>2 - Normal Priority</option>
                                                    <option value="3">3 - Lowest Priority</option>
                                    </select>
                                                <div class="form-text">
                                                    <strong>Global Priority System:</strong> Items are numbered continuously across all priority levels<br>
                                                    
                                                </div>
                                            </div>
                                </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Form Actions -->
                            <div class="row mt-4">
                                <div class="col-12">
                            <div class="d-flex justify-content-between">
                                        <div>
                                            <a href="/whatsnew/list" class="btn btn-outline-secondary">
                                    <i class="bi bi-x-circle me-1"></i>Cancel
                                </a>
                                        </div>
                                <div>
                                            <button type="reset" class="btn btn-outline-warning me-2">
                                        <i class="bi bi-arrow-clockwise me-1"></i>Reset
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        <i class="bi bi-check-circle me-1"></i>
                                        <span th:text="${isEdit} ? 'Update Item' : 'Create Item'">Create Item</span>
                                    </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    <!-- Enhanced Footer -->
    <footer class="enhanced-footer">
        <div class="container">
            <div class="row">
                <!-- Company Information -->
                <div class="col-md-4 mb-3">
                    <div class="footer-brand">
                        <img src="/images/logo.png" alt="HP Logo" class="me-2" style="height: 24px; width: auto;">Visakh Refinery Portal
                    </div>
                    <p class="text-muted mb-2" style="font-size: 0.9rem;">
                        Advanced management system for refinery operations and announcements.
                    </p>
                </div>
                
                <!-- Quick Links -->
                <div class="col-md-4 mb-3">
                    <h6 class="text-white mb-2" style="font-size: 1rem;">Quick Links</h6>
                    <ul class="footer-links">
                        <li><a th:href="@{/}"><i class="bi bi-house me-1"></i>Dashboard</a></li>
                        <li><a th:href="@{/whatsnew/list}"><i class="bi bi-list-ul me-1"></i>View All</a></li>
                        <li sec:authorize="hasRole('ADMIN')"><a th:href="@{/whatsnew/add}"><i class="bi bi-plus-circle me-1"></i>Add New</a></li>
                    </ul>
                </div>
                
                <!-- User & Status -->
                <div class="col-md-4 mb-3">
                    <h6 class="text-white mb-2" style="font-size: 1rem;">Current Session</h6>
                    <ul class="footer-links">
                        <li><i class="bi bi-person-check me-1"></i>User: 
                            <span sec:authorize="isAuthenticated()" sec:authentication="name" class="text-info"></span>
                            <span sec:authorize="!isAuthenticated()" class="text-light">Guest</span>
                        </li>
                        <li><i class="bi bi-shield-check me-1"></i>Security: <span class="text-success">Active</span></li>
                        <li><i class="bi bi-server me-1"></i>Status: <span class="text-success">Online</span></li>
                    </ul>
                </div>
            </div>
            
            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p class="mb-0 text-white" style="font-size: 0.9rem;">
                            <i class="bi bi-c-circle me-1"></i>2024 Visakh Refinery Portal. All rights reserved.
                        </p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p class="mb-0 text-white" style="font-size: 0.9rem;">
                            <i class="bi bi-clock me-1"></i>
                            Server Time: <span th:text="${#temporals.format(#temporals.createNow(), 'dd-MMM-yyyy HH:mm:ss')}"></span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- External JavaScript Files -->
    <script th:src="@{/js/form-enhancements.js}"></script>
    
    <!-- Page Specific JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize comprehensive form enhancements
            setupFormEnhancements({
                enableCharacterCount: true,
                enableAutoResize: true,
                enableRealTimeValidation: true,
                enablePreview: true,
                characterLimits: {
                    'title': 200,
                    'url': 500,
                    'description': 1000
                }
            });
        });
    </script>
</body>
</html> 